<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Windows 11</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, sans-serif; }
    
    body {
      height: 100vh;
      overflow: hidden;
      background: #000;
      user-select: none;
    }

    /* BIOS Screen */
    .bios-screen {
      position: fixed;
      inset: 0;
      background: #000;
      color: #aaa;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      padding: 20px;
      z-index: 1000;
      overflow: hidden;
    }

    .bios-header {
      color: #fff;
      background: #0000aa;
      padding: 5px 10px;
      margin-bottom: 20px;
    }

    .bios-line {
      margin: 3px 0;
      opacity: 0;
      animation: biosType 0.05s forwards;
    }

    @keyframes biosType {
      to { opacity: 1; }
    }

    .bios-progress {
      margin-top: 20px;
      color: #0f0;
    }

    /* Boot Logo Screen */
    .boot-screen {
      position: fixed;
      inset: 0;
      background: #000;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }

    .manufacturer-logo {
      font-size: 48px;
      color: #fff;
      margin-bottom: 30px;
      opacity: 0;
      animation: fadeInOut 2s forwards;
    }

    @keyframes fadeInOut {
      0% { opacity: 0; }
      30% { opacity: 1; }
      70% { opacity: 1; }
      100% { opacity: 0; }
    }

    /* Windows Loading Screen */
    .loading-screen {
      position: fixed;
      inset: 0;
      background: #000;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 998;
    }

    .windows-logo {
      width: 100px;
      height: 100px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4px;
      margin-bottom: 40px;
    }

    .win-square {
      background: #0078d4;
      border-radius: 2px;
      animation: winPulse 2s ease-in-out infinite;
    }

    .win-square:nth-child(1) { animation-delay: 0s; }
    .win-square:nth-child(2) { animation-delay: 0.1s; }
    .win-square:nth-child(3) { animation-delay: 0.2s; }
    .win-square:nth-child(4) { animation-delay: 0.3s; }

    @keyframes winPulse {
      0%, 100% { opacity: 0.3; transform: scale(0.95); }
      50% { opacity: 1; transform: scale(1); }
    }

    .loading-dots {
      display: flex;
      gap: 8px;
    }

    .loading-dot {
      width: 8px;
      height: 8px;
      background: #fff;
      border-radius: 50%;
      animation: dotSpin 1.5s ease-in-out infinite;
    }

    .loading-dot:nth-child(1) { animation-delay: 0s; }
    .loading-dot:nth-child(2) { animation-delay: 0.15s; }
    .loading-dot:nth-child(3) { animation-delay: 0.3s; }
    .loading-dot:nth-child(4) { animation-delay: 0.45s; }
    .loading-dot:nth-child(5) { animation-delay: 0.6s; }

    @keyframes dotSpin {
      0% { transform: translateY(0); opacity: 0.3; }
      50% { transform: translateY(-10px); opacity: 1; }
      100% { transform: translateY(0); opacity: 0.3; }
    }

    .loading-text {
      color: #fff;
      margin-top: 30px;
      font-size: 14px;
      opacity: 0;
      animation: fadeIn 0.5s forwards 1s;
    }

    @keyframes fadeIn {
      to { opacity: 1; }
    }

    /* Lock Screen */
    .lock-screen {
      position: fixed;
      inset: 0;
      background: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920') center/cover;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      padding-bottom: 100px;
      z-index: 997;
      cursor: pointer;
    }

    .lock-time {
      position: absolute;
      bottom: 150px;
      left: 50px;
      color: #fff;
      text-shadow: 0 2px 10px rgba(0,0,0,0.5);
    }

    .lock-time .time {
      font-size: 96px;
      font-weight: 300;
    }

    .lock-time .date {
      font-size: 24px;
      font-weight: 300;
    }

    .lock-hint {
      color: #fff;
      font-size: 14px;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; }
    }

    /* Login Screen */
    .login-screen {
      position: fixed;
      inset: 0;
      background: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920') center/cover;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 996;
    }

    .login-screen::before {
      content: '';
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(20px);
    }

    .login-box {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }

    .user-avatar-large {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 64px;
      color: #fff;
      margin-bottom: 10px;
    }

    .user-name-large {
      color: #fff;
      font-size: 28px;
      font-weight: 300;
    }

    .password-box {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .password-input {
      width: 250px;
      padding: 12px 15px;
      border: none;
      border-radius: 4px;
      background: rgba(255,255,255,0.9);
      font-size: 14px;
    }

    .password-input:focus { outline: none; }

    .submit-btn {
      width: 40px;
      height: 40px;
      border: none;
      border-radius: 4px;
      background: rgba(255,255,255,0.9);
      cursor: pointer;
      font-size: 16px;
    }

    .submit-btn:hover { background: #fff; }

    .login-options {
      display: flex;
      gap: 20px;
      margin-top: 20px;
    }

    .login-option {
      color: #fff;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }

    .login-option:hover { opacity: 0.8; }

    /* Welcome Screen */
    .welcome-screen {
      position: fixed;
      inset: 0;
      background: #0078d4;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 995;
      color: #fff;
    }

    .welcome-text {
      font-size: 42px;
      font-weight: 300;
      margin-bottom: 40px;
    }

    .welcome-dots {
      display: flex;
      gap: 8px;
    }

    .welcome-dot {
      width: 10px;
      height: 10px;
      background: rgba(255,255,255,0.5);
      border-radius: 50%;
      animation: welcomePulse 1.5s ease-in-out infinite;
    }

    .welcome-dot:nth-child(1) { animation-delay: 0s; }
    .welcome-dot:nth-child(2) { animation-delay: 0.2s; }
    .welcome-dot:nth-child(3) { animation-delay: 0.4s; }

    @keyframes welcomePulse {
      0%, 100% { background: rgba(255,255,255,0.3); }
      50% { background: rgba(255,255,255,1); }
    }

    /* Desktop */
    .desktop-container {
      display: none;
      height: 100vh;
      background: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920') center/cover;
      animation: desktopFadeIn 0.8s ease;
    }

    @keyframes desktopFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .desktop {
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      height: calc(100vh - 48px);
    }

    .icon {
      width: 80px;
      padding: 8px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .icon:hover { background: rgba(255,255,255,0.2); }
    .icon:active { background: rgba(255,255,255,0.3); }

    .icon-img {
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
    }

    .icon span {
      color: white;
      font-size: 12px;
      text-align: center;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
    }

    /* Taskbar */
    .taskbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 48px;
      background: rgba(32, 32, 32, 0.85);
      backdrop-filter: blur(20px);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 10px;
      z-index: 100;
    }

    .taskbar-center {
      display: flex;
      gap: 4px;
      align-items: center;
    }

    .taskbar-btn {
      width: 44px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.2s;
      font-size: 20px;
    }

    .taskbar-btn:hover { background: rgba(255,255,255,0.1); }

    .start-btn {
      background: linear-gradient(135deg, #0078d4, #00bcf2);
      border-radius: 4px;
    }

    .taskbar-right {
      position: absolute;
      right: 10px;
      display: flex;
      align-items: center;
      gap: 5px;
      color: white;
      font-size: 12px;
    }

    .system-tray {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 8px;
      border-radius: 4px;
      cursor: pointer;
    }

    .system-tray:hover { background: rgba(255,255,255,0.1); }

    .clock {
      text-align: center;
      padding: 4px 12px;
      border-radius: 4px;
      cursor: pointer;
    }

    .clock:hover { background: rgba(255,255,255,0.1); }

    /* Start Menu */
    .start-menu {
      position: fixed;
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%) scale(0.95);
      width: 600px;
      height: 650px;
      background: rgba(32, 32, 32, 0.95);
      backdrop-filter: blur(30px);
      border-radius: 8px;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s ease;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
    }

    .start-menu.open {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) scale(1);
    }

    .start-content {
      padding: 40px 50px;
      color: white;
    }

    .search-box {
      width: 100%;
      padding: 10px 15px;
      border-radius: 20px;
      border: none;
      background: rgba(255,255,255,0.1);
      color: white;
      font-size: 14px;
      margin-bottom: 30px;
    }

    .search-box::placeholder { color: rgba(255,255,255,0.5); }
    .search-box:focus { outline: none; background: rgba(255,255,255,0.15); }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 15px;
    }

    .pinned-apps {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 5px;
      margin-bottom: 30px;
    }

    .app-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 12px 8px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .app-item:hover { background: rgba(255,255,255,0.1); }

    .app-item .icon-img { font-size: 28px; }
    .app-item span { font-size: 11px; color: rgba(255,255,255,0.9); }

    .recommended {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 5px;
    }

    .rec-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .rec-item:hover { background: rgba(255,255,255,0.1); }
    .rec-item .icon-img { font-size: 24px; }
    .rec-info span { display: block; font-size: 12px; }
    .rec-info .time { color: rgba(255,255,255,0.5); font-size: 11px; }

    .user-section {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 15px 50px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0,0,0,0.2);
      color: white;
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
    }

    .user-profile:hover { background: rgba(255,255,255,0.1); }

    .user-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .power-btn {
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 18px;
    }

    .power-btn:hover { background: rgba(255,255,255,0.1); }

    /* Window */
    .window {
      position: fixed;
      width: 800px;
      height: 500px;
      background: #1e1e1e;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      display: none;
      z-index: 50;
    }

    .window.open { display: block; animation: windowOpen 0.2s ease; }

    @keyframes windowOpen {
      from { transform: scale(0.95); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .window-header {
      height: 32px;
      background: #2d2d2d;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 10px;
    }

    .window-title {
      color: white;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .window-controls { display: flex; }

    .win-btn {
      width: 46px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 10px;
      cursor: pointer;
    }

    .win-btn:hover { background: rgba(255,255,255,0.1); }
    .win-btn.close:hover { background: #e81123; }

    .window-body {
      height: calc(100% - 32px);
      background: #1e1e1e;
      color: white;
      padding: 20px;
      overflow: auto;
    }

    .explorer-body {
      display: flex;
      height: 100%;
      padding: 0;
    }

    .sidebar {
      width: 200px;
      background: #2d2d2d;
      padding: 10px;
    }

    .sidebar-item {
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 13px;
      color: white;
    }

    .sidebar-item:hover { background: rgba(255,255,255,0.1); }
    .sidebar-item.active { background: rgba(255,255,255,0.15); }

    .explorer-main {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .explorer-toolbar {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: #252525;
      border-bottom: 1px solid #3a3a3a;
    }

    .nav-btn {
      width: 28px;
      height: 28px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #fff;
      font-size: 14px;
      transition: background 0.2s;
    }

    .nav-btn:hover { background: rgba(255,255,255,0.1); }
    .nav-btn.disabled { opacity: 0.3; pointer-events: none; }

    .address-bar {
      flex: 1;
      display: flex;
      align-items: center;
      background: #1e1e1e;
      border-radius: 4px;
      padding: 6px 12px;
      gap: 6px;
    }

    .address-bar span {
      color: #888;
      font-size: 13px;
    }

    .path-text {
      color: #fff !important;
      font-size: 13px;
    }

    .explorer-content {
      flex: 1;
      padding: 15px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: 10px;
      align-content: start;
      overflow-y: auto;
    }

    .folder-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
    }

    .folder-item:hover { background: rgba(255,255,255,0.1); }
    .folder-item.selected { background: rgba(0,120,212,0.3); }
    .folder-item span { font-size: 12px; color: white; text-align: center; word-break: break-word; }

    /* Context Menu */
    .context-menu {
      position: fixed;
      background: rgba(45, 45, 45, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 8px;
      padding: 5px;
      min-width: 200px;
      display: none;
      z-index: 200;
      box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    }

    .context-menu.open { display: block; }

    .context-item {
      padding: 8px 12px;
      color: white;
      font-size: 13px;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .context-item:hover { background: rgba(255,255,255,0.1); }

    .context-divider {
      height: 1px;
      background: rgba(255,255,255,0.1);
      margin: 5px 0;
    }

    /* Shutdown Screen */
    .shutdown-screen {
      position: fixed;
      inset: 0;
      background: #000;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }

    .shutdown-text {
      color: #fff;
      font-size: 24px;
      margin-bottom: 30px;
    }

    /* Browser Styles */
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .browser-tab {
      cursor: pointer;
      transition: background 0.2s;
    }

    .browser-tab:hover {
      background: #333 !important;
    }

    .quick-links {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      max-width: 500px;
      margin: 30px auto;
    }

    .quick-link {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 15px;
      border-radius: 12px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .quick-link:hover {
      background: rgba(0,0,0,0.05);
    }

    .quick-link-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .quick-link span {
      font-size: 12px;
      color: #333;
    }

    /* Calendar Popup */
    .calendar-popup {
      position: fixed;
      bottom: 60px;
      right: 10px;
      width: 320px;
      background: rgba(32, 32, 32, 0.95);
      backdrop-filter: blur(30px);
      border-radius: 8px;
      padding: 20px;
      display: none;
      z-index: 150;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      color: white;
    }
    .calendar-popup.open { display: block; }
    .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .calendar-nav { cursor: pointer; padding: 5px 10px; border-radius: 4px; }
    .calendar-nav:hover { background: rgba(255,255,255,0.1); }
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; text-align: center; }
    .calendar-day { padding: 8px; border-radius: 50%; cursor: pointer; font-size: 13px; }
    .calendar-day:hover { background: rgba(255,255,255,0.1); }
    .calendar-day.today { background: #0078d4; }
    .calendar-day.header { font-weight: bold; color: #888; font-size: 11px; }
    .calendar-day.other-month { color: #666; }

    /* Quick Settings Panel */
    .quick-settings {
      position: fixed;
      bottom: 60px;
      right: 10px;
      width: 360px;
      background: rgba(32, 32, 32, 0.95);
      backdrop-filter: blur(30px);
      border-radius: 8px;
      padding: 20px;
      display: none;
      z-index: 150;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      color: white;
    }
    .quick-settings.open { display: block; }
    .qs-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 20px; }
    .qs-btn { padding: 15px 10px; border-radius: 8px; background: #3d3d3d; cursor: pointer; text-align: center; transition: all 0.2s; }
    .qs-btn:hover { background: #4d4d4d; }
    .qs-btn.active { background: #0078d4; }
    .qs-btn span { display: block; font-size: 20px; margin-bottom: 5px; }
    .qs-btn small { font-size: 11px; color: #aaa; }
    .qs-slider { margin: 15px 0; }
    .qs-slider label { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; font-size: 13px; }
    .qs-slider input[type="range"] { flex: 1; accent-color: #0078d4; }

    /* Taskbar App Indicators */
    .taskbar-btn.running::after {
      content: '';
      position: absolute;
      bottom: 2px;
      left: 50%;
      transform: translateX(-50%);
      width: 6px;
      height: 3px;
      background: #0078d4;
      border-radius: 2px;
    }
    .taskbar-btn { position: relative; }

    /* Window Resizable */
    .window { min-width: 300px; min-height: 200px; }
    .window.maximized { 
      top: 0 !important; 
      left: 0 !important; 
      width: 100% !important; 
      height: calc(100vh - 48px) !important; 
      border-radius: 0; 
    }
    .window.minimized { display: none !important; }
    .resize-handle {
      position: absolute;
      background: transparent;
    }
    .resize-handle.se { right: 0; bottom: 0; width: 15px; height: 15px; cursor: se-resize; }
    .resize-handle.sw { left: 0; bottom: 0; width: 15px; height: 15px; cursor: sw-resize; }
    .resize-handle.ne { right: 0; top: 0; width: 15px; height: 15px; cursor: ne-resize; }
    .resize-handle.nw { left: 0; top: 0; width: 15px; height: 15px; cursor: nw-resize; }
    .resize-handle.n { top: 0; left: 15px; right: 15px; height: 5px; cursor: n-resize; }
    .resize-handle.s { bottom: 0; left: 15px; right: 15px; height: 5px; cursor: s-resize; }
    .resize-handle.e { right: 0; top: 15px; bottom: 15px; width: 5px; cursor: e-resize; }
    .resize-handle.w { left: 0; top: 15px; bottom: 15px; width: 5px; cursor: w-resize; }

    /* Calculator */
    .calc-display { background: #1a1a1a; padding: 20px; text-align: right; font-size: 32px; margin-bottom: 10px; border-radius: 4px; }
    .calc-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; }
    .calc-btn { padding: 18px; font-size: 18px; border: none; border-radius: 4px; cursor: pointer; transition: background 0.2s; }
    .calc-btn.num { background: #3d3d3d; color: white; }
    .calc-btn.num:hover { background: #4d4d4d; }
    .calc-btn.op { background: #2d2d2d; color: white; }
    .calc-btn.op:hover { background: #3d3d3d; }
    .calc-btn.eq { background: #0078d4; color: white; }
    .calc-btn.eq:hover { background: #1084d8; }

    /* Terminal */
    .terminal-output { font-family: 'Consolas', monospace; font-size: 14px; white-space: pre-wrap; margin-bottom: 10px; }
    .terminal-input { display: flex; align-items: center; }
    .terminal-prompt { color: #0a0; margin-right: 8px; }
    .terminal-input input { flex: 1; background: transparent; border: none; color: white; font-family: 'Consolas', monospace; font-size: 14px; outline: none; }

    /* Task Manager */
    .task-list { margin-top: 10px; }
    .task-item { display: flex; justify-content: space-between; padding: 10px; background: #2d2d2d; margin-bottom: 5px; border-radius: 4px; align-items: center; }
    .task-item:hover { background: #3d3d3d; }
    .task-info { display: flex; align-items: center; gap: 10px; }
    .task-end { padding: 5px 10px; background: #e81123; border: none; color: white; border-radius: 4px; cursor: pointer; font-size: 12px; }

    /* Widgets Panel */
    .widgets-panel {
      position: fixed;
      top: 0;
      left: -400px;
      width: 400px;
      height: calc(100vh - 48px);
      background: rgba(32, 32, 32, 0.95);
      backdrop-filter: blur(30px);
      transition: left 0.3s ease;
      z-index: 90;
      padding: 20px;
      overflow-y: auto;
      color: white;
    }
    .widgets-panel.open { left: 0; }
    .widget-card { background: #2d2d2d; border-radius: 12px; padding: 20px; margin-bottom: 15px; }
    .widget-title { font-size: 14px; font-weight: 600; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
    .weather-main { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
    .weather-temp { font-size: 48px; font-weight: 300; }
    .weather-icon { font-size: 48px; }
    .weather-details { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; font-size: 12px; color: #aaa; }

    /* Paint App */
    .paint-toolbar { display: flex; gap: 10px; padding: 10px; background: #2d2d2d; align-items: center; flex-wrap: wrap; }
    .paint-colors { display: flex; gap: 5px; }
    .paint-color { width: 24px; height: 24px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; }
    .paint-color.active { border-color: white; }
    .paint-canvas { background: white; cursor: crosshair; }
    .paint-sizes { display: flex; gap: 5px; align-items: center; }
    .paint-size { width: 30px; height: 30px; border-radius: 4px; background: #3d3d3d; display: flex; align-items: center; justify-content: center; cursor: pointer; color: white; font-size: 12px; }
    .paint-size.active { background: #0078d4; }

    /* Alt+Tab Switcher */
    .alt-tab-switcher {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(32, 32, 32, 0.95);
      backdrop-filter: blur(30px);
      border-radius: 12px;
      padding: 20px;
      display: none;
      z-index: 3000;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
    }
    .alt-tab-switcher.open { display: flex; gap: 15px; }
    .alt-tab-item { width: 150px; padding: 15px; border-radius: 8px; text-align: center; cursor: pointer; color: white; }
    .alt-tab-item.selected { background: rgba(255,255,255,0.2); }
    .alt-tab-item span { font-size: 32px; display: block; margin-bottom: 8px; }
    .alt-tab-item small { font-size: 11px; }

    /* BSOD */
    .bsod-screen {
      position: fixed;
      inset: 0;
      background: #0078d4;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 5000;
      color: white;
      text-align: center;
      padding: 50px;
    }
    .bsod-screen.show { display: flex; }
    .bsod-sad { font-size: 120px; margin-bottom: 30px; }
    .bsod-title { font-size: 28px; margin-bottom: 20px; }
    .bsod-text { font-size: 14px; max-width: 600px; line-height: 1.6; color: rgba(255,255,255,0.8); }
    .bsod-qr { margin-top: 30px; font-size: 60px; }

    /* Lock Screen Overlay */
    .lock-overlay {
      position: fixed;
      inset: 0;
      background: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920') center/cover;
      display: none;
      z-index: 2500;
    }
    .lock-overlay.show { display: flex; flex-direction: column; align-items: center; justify-content: center; }
  </style>
</head>
<body>
  <!-- BIOS Screen -->
  <div class="bios-screen" id="biosScreen">
    <div class="bios-header">American Megatrends BIOS v2.85</div>
    <div id="biosContent"></div>
  </div>

  <!-- Boot Logo Screen -->
  <div class="boot-screen" id="bootScreen">
    <div class="manufacturer-logo">ğŸ–¥ï¸ ASUS</div>
  </div>

  <!-- Windows Loading Screen -->
  <div class="loading-screen" id="loadingScreen">
    <div class="windows-logo">
      <div class="win-square"></div>
      <div class="win-square"></div>
      <div class="win-square"></div>
      <div class="win-square"></div>
    </div>
    <div class="loading-dots">
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
    </div>
    <div class="loading-text" id="loadingText">Getting things ready</div>
  </div>

  <!-- Lock Screen -->
  <div class="lock-screen" id="lockScreen">
    <div class="lock-time">
      <div class="time" id="lockTime">12:00</div>
      <div class="date" id="lockDate">×™×•× ×—××™×©×™, 18 ×‘×“×¦××‘×¨</div>
    </div>
    <div class="lock-hint">×œ×—×¥ ××• ×”×§×© ×œ×”××©×š</div>
  </div>

  <!-- Login Screen -->
  <div class="login-screen" id="loginScreen">
    <div class="login-box">
      <div class="user-avatar-large">ğŸ‘¤</div>
      <div class="user-name-large">×©×œ×•×</div>
      <div class="password-box">
        <input type="password" class="password-input" placeholder="×¡×™×¡××”" id="passwordInput">
        <button class="submit-btn" onclick="login()">â†’</button>
      </div>
      <div class="login-options">
        <div class="login-option">ğŸ”‘<span>PIN</span></div>
        <div class="login-option">ğŸ‘†<span>×˜×‘×™×¢×ª ××¦×‘×¢</span></div>
        <div class="login-option">ğŸ‘ï¸<span>×–×™×”×•×™ ×¤× ×™×</span></div>
      </div>
    </div>
  </div>

  <!-- Welcome Screen -->
  <div class="welcome-screen" id="welcomeScreen">
    <div class="welcome-text">×‘×¨×•×š ×”×‘×</div>
    <div class="welcome-dots">
      <div class="welcome-dot"></div>
      <div class="welcome-dot"></div>
      <div class="welcome-dot"></div>
    </div>
  </div>

  <!-- Shutdown Screen -->
  <div class="shutdown-screen" id="shutdownScreen">
    <div class="shutdown-text" id="shutdownText">××›×‘×”...</div>
    <div class="loading-dots">
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
      <div class="loading-dot"></div>
    </div>
  </div>

  <!-- Desktop -->
  <div class="desktop-container" id="desktopContainer">
    <div class="desktop">
      <div class="icon" ondblclick="openWindow('explorer')">
        <div class="icon-img">ğŸ“</div>
        <span>This PC</span>
      </div>
      <div class="icon" ondblclick="openWindow('edge')">
        <div class="icon-img">ğŸŒ</div>
        <span>Edge</span>
      </div>
      <div class="icon">
        <div class="icon-img">ğŸ—‘ï¸</div>
        <span>Recycle Bin</span>
      </div>
      <div class="icon" ondblclick="openWindow('notepad')">
        <div class="icon-img">ğŸ“</div>
        <span>Notepad</span>
      </div>
      <div class="icon" ondblclick="openWindow('settings')">
        <div class="icon-img">âš™ï¸</div>
        <span>Settings</span>
      </div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar">
      <div class="taskbar-btn" onclick="toggleWidgets()" style="position: absolute; left: 10px;">ğŸ“°</div>
      <div class="taskbar-center">
        <div class="taskbar-btn start-btn" onclick="toggleStartMenu()">ğŸªŸ</div>
        <div class="taskbar-btn" id="taskbar-edge" onclick="openWindow('edge')">ğŸŒ</div>
        <div class="taskbar-btn" id="taskbar-explorer" onclick="openWindow('explorer')">ğŸ“</div>
        <div class="taskbar-btn" id="taskbar-terminal" onclick="openWindow('terminal')">â¬›</div>
        <div class="taskbar-btn" id="taskbar-notepad" onclick="openWindow('notepad')">ğŸ“</div>
      </div>
      <div class="taskbar-right">
        <div class="system-tray" onclick="toggleQuickSettings()">
          <span id="volumeIcon">ğŸ”Š</span>
          <span>ğŸ“¶</span>
          <span>ğŸ”‹</span>
        </div>
        <div class="clock" id="clock" onclick="toggleCalendar()">
          <div id="time">12:00</div>
          <div id="date">01/01/2024</div>
        </div>
      </div>
    </div>

    <!-- Start Menu -->
    <div class="start-menu" id="startMenu">
      <div class="start-content">
        <input type="text" class="search-box" id="startSearch" placeholder="ğŸ” ×—×™×¤×•×© ××¤×œ×™×§×¦×™×•×ª, ×”×’×“×¨×•×ª ×•××¡××›×™×" oninput="filterApps(this.value)">
        <div class="section-title">Pinned</div>
        <div class="pinned-apps" id="pinnedApps">
          <div class="app-item" data-name="edge" onclick="openWindow('edge')"><div class="icon-img">ğŸŒ</div><span>Edge</span></div>
          <div class="app-item" data-name="explorer" onclick="openWindow('explorer')"><div class="icon-img">ğŸ“</div><span>Explorer</span></div>
          <div class="app-item" data-name="terminal" onclick="openWindow('terminal')"><div class="icon-img">â¬›</div><span>Terminal</span></div>
          <div class="app-item" data-name="calculator" onclick="openWindow('calculator')"><div class="icon-img">ğŸ§®</div><span>Calculator</span></div>
          <div class="app-item" data-name="notepad" onclick="openWindow('notepad')"><div class="icon-img">ğŸ“</div><span>Notepad</span></div>
          <div class="app-item" data-name="settings" onclick="openWindow('settings')"><div class="icon-img">âš™ï¸</div><span>Settings</span></div>
          <div class="app-item" data-name="paint" onclick="openWindow('paint')"><div class="icon-img">ğŸ¨</div><span>Paint</span></div>
          <div class="app-item" data-name="taskmanager" onclick="openWindow('taskmanager')"><div class="icon-img">ğŸ“Š</div><span>Task Manager</span></div>
          <div class="app-item" data-name="xbox" onclick="triggerBSOD()"><div class="icon-img">ğŸ®</div><span>Xbox</span></div>
          <div class="app-item" data-name="word"><div class="icon-img">ğŸ’¼</div><span>Word</span></div>
          <div class="app-item" data-name="excel"><div class="icon-img">ğŸ“ˆ</div><span>Excel</span></div>
          <div class="app-item" data-name="powerpoint"><div class="icon-img">ğŸ“‘</div><span>PowerPoint</span></div>
        </div>
        <div class="section-title">Recommended</div>
        <div class="recommended">
          <div class="rec-item"><div class="icon-img">ğŸ“„</div><div class="rec-info"><span>Document.docx</span><span class="time">×œ×¤× ×™ ×©×¢×”</span></div></div>
          <div class="rec-item"><div class="icon-img">ğŸ“Š</div><div class="rec-info"><span>Budget.xlsx</span><span class="time">××ª××•×œ</span></div></div>
        </div>
      </div>
      <div class="user-section">
        <div class="user-profile" onclick="lockScreen()">
          <div class="user-avatar">ğŸ‘¤</div>
          <span style="font-size: 13px;">×©×œ×•×</span>
        </div>
        <div class="power-btn" onclick="shutdown()">â»</div>
      </div>
    </div>

    <!-- Windows -->
    <div class="window" id="explorerWindow" style="top: 50px; left: 100px;">
      <div class="window-header" onmousedown="startDrag(event, 'explorerWindow')" ondblclick="maximizeWindow('explorer')">
        <div class="window-title"><span>ğŸ“</span> File Explorer</div>
        <div class="window-controls">
          <div class="win-btn" onclick="minimizeWindow('explorer')">â”€</div>
          <div class="win-btn" onclick="maximizeWindow('explorer')">â˜</div>
          <div class="win-btn close" onclick="closeWindow('explorer')">âœ•</div>
        </div>
      </div>
      <div class="window-body explorer-body">
        <div class="sidebar">
          <div class="sidebar-item active" onclick="navigateTo('Desktop')" data-location="Desktop">ğŸ“ Desktop</div>
          <div class="sidebar-item" onclick="navigateTo('Downloads')" data-location="Downloads">â¬‡ï¸ Downloads</div>
          <div class="sidebar-item" onclick="navigateTo('Documents')" data-location="Documents">ğŸ“„ Documents</div>
          <div class="sidebar-item" onclick="navigateTo('Pictures')" data-location="Pictures">ğŸ–¼ï¸ Pictures</div>
          <div class="sidebar-item" onclick="navigateTo('Music')" data-location="Music">ğŸµ Music</div>
          <div class="sidebar-item" onclick="navigateTo('This PC')" data-location="This PC">ğŸ’» This PC</div>
        </div>
        <div class="explorer-main">
          <div class="explorer-toolbar">
            <div class="nav-btn disabled" id="backBtn" onclick="goBack()">â†</div>
            <div class="nav-btn disabled" id="forwardBtn" onclick="goForward()">â†’</div>
            <div class="nav-btn" onclick="navigateTo(currentPath.split('/')[0] || 'This PC')">â†‘</div>
            <div class="address-bar">
              <span>ğŸ“</span>
              <span class="path-text" id="pathDisplay">This PC</span>
            </div>
            <div class="nav-btn" onclick="refreshExplorer()">ğŸ”„</div>
          </div>
          <div class="explorer-content" id="explorerContent">
            <!-- Content will be generated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <div class="window" id="notepadWindow" style="top: 80px; left: 150px; width: 600px; height: 400px;">
      <div class="window-header" onmousedown="startDrag(event, 'notepadWindow')" ondblclick="maximizeWindow('notepad')">
        <div class="window-title"><span>ğŸ“</span> Notepad</div>
        <div class="window-controls">
          <div class="win-btn" onclick="minimizeWindow('notepad')">â”€</div>
          <div class="win-btn" onclick="maximizeWindow('notepad')">â˜</div>
          <div class="win-btn close" onclick="closeWindow('notepad')">âœ•</div>
        </div>
      </div>
      <div class="window-body" style="padding: 0;">
        <textarea style="width: 100%; height: 100%; background: #1e1e1e; color: white; border: none; resize: none; padding: 15px; font-family: Consolas, monospace; font-size: 14px;" placeholder="×”×ª×—×œ ×œ×›×ª×•×‘..."></textarea>
      </div>
    </div>

    <div class="window" id="settingsWindow" style="top: 60px; left: 200px; width: 850px; height: 500px;">
      <div class="window-header" onmousedown="startDrag(event, 'settingsWindow')" ondblclick="maximizeWindow('settings')">
        <div class="window-title"><span>âš™ï¸</span> Settings</div>
        <div class="window-controls">
          <div class="win-btn" onclick="minimizeWindow('settings')">â”€</div>
          <div class="win-btn" onclick="maximizeWindow('settings')">â˜</div>
          <div class="win-btn close" onclick="closeWindow('settings')">âœ•</div>
        </div>
      </div>
      <div class="window-body explorer-body">
        <div class="sidebar" style="width: 220px;">
          <div class="sidebar-item active">ğŸ  Home</div>
          <div class="sidebar-item">ğŸ–¥ï¸ System</div>
          <div class="sidebar-item">ğŸ“± Bluetooth</div>
          <div class="sidebar-item">ğŸ“¶ Network</div>
          <div class="sidebar-item">ğŸ¨ Personalization</div>
          <div class="sidebar-item">ğŸ“¦ Apps</div>
          <div class="sidebar-item">ğŸ”’ Privacy</div>
          <div class="sidebar-item">ğŸ”„ Update</div>
        </div>
        <div class="explorer-content" style="flex-direction: column; display: flex; gap: 15px; align-content: unset;">
          <h2 style="font-size: 24px; margin: 0;">Settings</h2>
          <div style="background: #2d2d2d; padding: 15px; border-radius: 8px;">
            <div style="font-size: 14px;">Windows 11 Pro</div>
            <div style="font-size: 12px; color: #888;">Version 23H2</div>
          </div>
        </div>
      </div>
    </div>

    <div class="window" id="edgeWindow" style="top: 40px; left: 120px; width: 900px; height: 550px;">
      <div class="window-header" onmousedown="startDrag(event, 'edgeWindow')" ondblclick="maximizeWindow('edge')">
        <div class="window-title"><span>ğŸŒ</span> Microsoft Edge</div>
        <div class="window-controls">
          <div class="win-btn" onclick="minimizeWindow('edge')">â”€</div>
          <div class="win-btn" onclick="maximizeWindow('edge')">â˜</div>
          <div class="win-btn close" onclick="closeWindow('edge')">âœ•</div>
        </div>
      </div>
      <div class="window-body" style="padding: 0; display: flex; flex-direction: column;">
        <div class="browser-toolbar" style="background: #2d2d2d; padding: 8px 12px; display: flex; gap: 8px; align-items: center;">
          <div class="nav-btn" onclick="browserBack()" title="Back">â†</div>
          <div class="nav-btn" onclick="browserForward()" title="Forward">â†’</div>
          <div class="nav-btn" onclick="browserRefresh()" title="Refresh">ğŸ”„</div>
          <div class="nav-btn" onclick="browserHome()" title="Home">ğŸ </div>
          <input type="text" id="browserUrl" value="https://www.google.com/webhp?igu=1" 
            style="flex: 1; padding: 8px 12px; border-radius: 20px; border: none; background: #1e1e1e; color: white; font-size: 13px;"
            onkeypress="if(event.key==='Enter') browserNavigate()">
          <div class="nav-btn" onclick="browserNavigate()" title="Go">âœ</div>
        </div>
        <div class="browser-tabs" style="background: #252525; padding: 4px 8px; display: flex; gap: 2px; align-items: center;">
          <div class="browser-tab active" style="background: #1e1e1e; padding: 6px 12px; border-radius: 8px 8px 0 0; font-size: 12px; color: #fff; display: flex; align-items: center; gap: 6px; max-width: 200px;">
            <span id="tabIcon">ğŸŒ</span>
            <span id="tabTitle" style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">New Tab</span>
          </div>
          <div style="padding: 4px 10px; color: #888; cursor: pointer; font-size: 16px;">+</div>
        </div>
        <div class="browser-content" style="flex: 1; position: relative; background: #fff;">
          <iframe id="browserFrame" 
            src="https://www.google.com/webhp?igu=1" 
            style="width: 100%; height: 100%; border: none;"
            sandbox="allow-same-origin allow-scripts allow-popups allow-forms"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
          </iframe>
          <div id="browserLoading" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #333;">
            <div style="font-size: 32px; animation: spin 1s linear infinite;">â³</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
      <div class="context-item" onclick="document.getElementById('desktopContainer').style.background = 'url(https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920) center/cover'">ğŸ‘ï¸ View</div>
      <div class="context-item">ğŸ“‹ Sort by</div>
      <div class="context-item" onclick="location.reload()">ğŸ”„ Refresh</div>
      <div class="context-divider"></div>
      <div class="context-item" onclick="createNewFolder()">ğŸ“ New folder</div>
      <div class="context-item" onclick="createNewFile()">ğŸ“„ New file</div>
      <div class="context-divider"></div>
      <div class="context-item" onclick="openWindow('settings')">ğŸ–¼ï¸ Personalize</div>
      <div class="context-item" onclick="openWindow('settings')">âš™ï¸ Display settings</div>
    </div>

    <!-- Calendar Popup -->
    <div class="calendar-popup" id="calendarPopup">
      <div class="calendar-header">
        <div class="calendar-nav" onclick="changeMonth(-1)">â—€</div>
        <div id="calendarMonth">December 2024</div>
        <div class="calendar-nav" onclick="changeMonth(1)">â–¶</div>
      </div>
      <div class="calendar-grid" id="calendarGrid"></div>
    </div>

    <!-- Quick Settings -->
    <div class="quick-settings" id="quickSettings">
      <div class="qs-grid">
        <div class="qs-btn active" onclick="this.classList.toggle('active')"><span>ğŸ“¶</span><small>Wi-Fi</small></div>
        <div class="qs-btn" onclick="this.classList.toggle('active')"><span>ğŸ“±</span><small>Bluetooth</small></div>
        <div class="qs-btn" onclick="this.classList.toggle('active')"><span>âœˆï¸</span><small>Airplane</small></div>
        <div class="qs-btn" onclick="this.classList.toggle('active')"><span>ğŸ”‹</span><small>Battery</small></div>
        <div class="qs-btn active" onclick="this.classList.toggle('active')"><span>ğŸŒ™</span><small>Night</small></div>
        <div class="qs-btn" onclick="this.classList.toggle('active')"><span>ğŸ”’</span><small>VPN</small></div>
      </div>
      <div class="qs-slider">
        <label>ğŸ”† <input type="range" min="0" max="100" value="80" id="brightnessSlider"> <span id="brightnessVal">80%</span></label>
      </div>
      <div class="qs-slider">
        <label>ğŸ”Š <input type="range" min="0" max="100" value="50" id="volumeSlider" oninput="updateVolume(this.value)"> <span id="volumeVal">50%</span></label>
      </div>
    </div>

    <!-- Widgets Panel -->
    <div class="widgets-panel" id="widgetsPanel">
      <div class="widget-card">
        <div class="widget-title">ğŸŒ¤ï¸ Weather</div>
        <div class="weather-main">
          <div class="weather-icon">â˜€ï¸</div>
          <div class="weather-temp">22Â°</div>
          <div style="color: #aaa;">Tel Aviv<br>Sunny</div>
        </div>
        <div class="weather-details">
          <div>ğŸ’§ 45%<br>Humidity</div>
          <div>ğŸ’¨ 12 km/h<br>Wind</div>
          <div>ğŸŒ¡ï¸ 18Â°-25Â°<br>Hi/Lo</div>
        </div>
      </div>
      <div class="widget-card">
        <div class="widget-title">ğŸ“° News</div>
        <div style="font-size: 13px; line-height: 1.6;">
          <div style="padding: 10px 0; border-bottom: 1px solid #444;">Tech Giants Report Record Earnings</div>
          <div style="padding: 10px 0; border-bottom: 1px solid #444;">New AI Breakthrough Announced</div>
          <div style="padding: 10px 0;">Space Mission Successfully Launches</div>
        </div>
      </div>
      <div class="widget-card">
        <div class="widget-title">ğŸ“ˆ Stocks</div>
        <div style="font-size: 13px;">
          <div style="display: flex; justify-content: space-between; padding: 8px 0;"><span>MSFT</span><span style="color: #4caf50;">â–² 2.3%</span></div>
          <div style="display: flex; justify-content: space-between; padding: 8px 0;"><span>AAPL</span><span style="color: #4caf50;">â–² 1.1%</span></div>
          <div style="display: flex; justify-content: space-between; padding: 8px 0;"><span>GOOGL</span><span style="color: #f44336;">â–¼ 0.5%</span></div>
        </div>
      </div>
    </div>

    <!-- Calculator Window -->
    <div class="window" id="calculatorWindow" style="top: 100px; left: 300px; width: 320px; height: 450px;">
      <div class="window-header" onmousedown="startDrag(event, 'calculatorWindow')">
        <div class="window-title"><span>ğŸ§®</span> Calculator</div>
        <div class="window-controls">
          <div class="win-btn" onclick="minimizeWindow('calculator')">â”€</div>
          <div class="win-btn" onclick="maximizeWindow('calculator')">â˜</div>
          <div class="win-btn close" onclick="closeWindow('calculator')">âœ•</div>
        </div>
      </div>
      <div class="window-body" style="padding: 15px;">
        <div class="calc-display" id="calcDisplay">0</div>
        <div class="calc-grid">
          <div class="calc-btn op" onclick="clearCalc()">C</div>
          <div class="calc-btn op" onclick="calcInput('Â±')">Â±</div>
          <div class="calc-btn op" onclick="calcInput('%')">%</div>
          <div class="calc-btn op" onclick="calcInput('/')">Ã·</div>
          <div class="calc-btn num" onclick="calcInput('7')">7</div>
          <div class="calc-btn num" onclick="calcInput('8')">8</div>
          <div class="calc-btn num" onclick="calcInput('9')">9</div>
          <div class="calc-btn op" onclick="calcInput('*')">Ã—</div>
          <div class="calc-btn num" onclick="calcInput('4')">4</div>
          <div class="calc-btn num" onclick="calcInput('5')">5</div>
          <div class="calc-btn num" onclick="calcInput('6')">6</div>
          <div class="calc-btn op" onclick="calcInput('-')">âˆ’</div>
          <div class="calc-btn num" onclick="calcInput('1')">1</div>
          <div class="calc-btn num" onclick="calcInput('2')">2</div>
          <div class="calc-btn num" onclick="calcInput('3')">3</div>
          <div class="calc-btn op" onclick="calcInput('+')">+</div>
          <div class="calc-btn num" onclick="calcInput('0')" style="grid-column: span 2;">0</div>
          <div class="calc-btn num" onclick="calcInput('.')">.</div>
          <div class="calc-btn eq" onclick="calcResult()">=</div>
        </div>
      </div>
    </div>

    <!-- Terminal Window -->
    <div class="window" id="terminalWindow" style="top: 80px; left: 200px; width: 700px; height: 400px;">
      <div class="window-header" onmousedown="startDrag(event, 'terminalWindow')">
        <div class="window-title"><span>â¬›</span> Windows Terminal</div>
        <div class="window-controls">
          <div class="win-btn" onclick="minimizeWindow('terminal')">â”€</div>
          <div class="win-btn" onclick="maximizeWindow('terminal')">â˜</div>
          <div class="win-btn close" onclick="closeWindow('terminal')">âœ•</div>
        </div>
      </div>
      <div class="window-body" style="background: #0c0c0c; padding: 15px; font-family: Consolas, monospace;">
        <div class="terminal-output" id="terminalOutput">Microsoft Windows [Version 10.0.22631.2861]
(c) Microsoft Corporation. All rights reserved.

</div>
        <div class="terminal-input">
          <span class="terminal-prompt">C:\Users\Shalom></span>
          <input type="text" id="terminalInput" onkeypress="if(event.key==='Enter') executeCommand()">
        </div>
      </div>
    </div>

    <!-- Task Manager Window -->
    <div class="window" id="taskmanagerWindow" style="top: 70px; left: 180px; width: 600px; height: 450px;">
      <div class="window-header" onmousedown="startDrag(event, 'taskmanagerWindow')">
        <div class="window-title"><span>ğŸ“Š</span> Task Manager</div>
        <div class="window-controls">
          <div class="win-btn" onclick="minimizeWindow('taskmanager')">â”€</div>
          <div class="win-btn" onclick="maximizeWindow('taskmanager')">â˜</div>
          <div class="win-btn close" onclick="closeWindow('taskmanager')">âœ•</div>
        </div>
      </div>
      <div class="window-body" style="padding: 15px;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
          <div style="background: #2d2d2d; padding: 15px; border-radius: 8px; text-align: center; flex: 1; margin-right: 10px;">
            <div style="font-size: 24px; color: #0078d4;" id="cpuUsage">23%</div>
            <div style="font-size: 12px; color: #888;">CPU</div>
          </div>
          <div style="background: #2d2d2d; padding: 15px; border-radius: 8px; text-align: center; flex: 1; margin-right: 10px;">
            <div style="font-size: 24px; color: #9c27b0;" id="memUsage">67%</div>
            <div style="font-size: 12px; color: #888;">Memory</div>
          </div>
          <div style="background: #2d2d2d; padding: 15px; border-radius: 8px; text-align: center; flex: 1;">
            <div style="font-size: 24px; color: #4caf50;" id="diskUsage">12%</div>
            <div style="font-size: 12px; color: #888;">Disk</div>
          </div>
        </div>
        <div style="font-size: 14px; font-weight: 600; margin-bottom: 10px;">Processes</div>
        <div class="task-list" id="taskList"></div>
      </div>
    </div>

    <!-- Paint Window -->
    <div class="window" id="paintWindow" style="top: 50px; left: 150px; width: 800px; height: 550px;">
      <div class="window-header" onmousedown="startDrag(event, 'paintWindow')">
        <div class="window-title"><span>ğŸ¨</span> Paint</div>
        <div class="window-controls">
          <div class="win-btn" onclick="minimizeWindow('paint')">â”€</div>
          <div class="win-btn" onclick="maximizeWindow('paint')">â˜</div>
          <div class="win-btn close" onclick="closeWindow('paint')">âœ•</div>
        </div>
      </div>
      <div class="window-body" style="padding: 0; display: flex; flex-direction: column;">
        <div class="paint-toolbar">
          <div class="paint-colors">
            <div class="paint-color active" style="background: #000" onclick="setPaintColor('#000', this)"></div>
            <div class="paint-color" style="background: #fff" onclick="setPaintColor('#fff', this)"></div>
            <div class="paint-color" style="background: #0078d4" onclick="setPaintColor('#0078d4', this)"></div>
            <div class="paint-color" style="background: #4caf50" onclick="setPaintColor('#4caf50', this)"></div>
            <div class="paint-color" style="background: #ff9800" onclick="setPaintColor('#ff9800', this)"></div>
            <div class="paint-color" style="background: #9c27b0" onclick="setPaintColor('#9c27b0', this)"></div>
            <div class="paint-color" style="background: #ffeb3b" onclick="setPaintColor('#ffeb3b', this)"></div>
          </div>
          <div class="paint-sizes">
            <div class="paint-size active" onclick="setPaintSize(2, this)">S</div>
            <div class="paint-size" onclick="setPaintSize(5, this)">M</div>
            <div class="paint-size" onclick="setPaintSize(10, this)">L</div>
          </div>
          <div class="nav-btn" onclick="clearCanvas()" style="margin-left: auto;">ğŸ—‘ï¸</div>
        </div>
        <canvas id="paintCanvas" class="paint-canvas" style="flex: 1;"></canvas>
      </div>
    </div>

    <!-- Alt+Tab Switcher -->
    <div class="alt-tab-switcher" id="altTabSwitcher"></div>

    <!-- BSOD Screen -->
    <div class="bsod-screen" id="bsodScreen">
      <div class="bsod-sad">:(</div>
      <div class="bsod-title">Your PC ran into a problem and needs to restart.</div>
      <div class="bsod-text">We're just collecting some error info, and then we'll restart for you.<br><br>0% complete</div>
      <div class="bsod-qr">â–£</div>
      <div class="bsod-text" style="margin-top: 20px;">For more information about this issue and possible fixes, visit<br>https://www.windows.com/stopcode</div>
      <div class="bsod-text" style="margin-top: 15px;">Stop code: CRITICAL_PROCESS_DIED</div>
    </div>

    <!-- Lock Overlay -->
    <div class="lock-overlay" id="lockOverlay">
      <div class="lock-time" style="position: relative; bottom: auto; left: auto; text-align: center;">
        <div class="time" id="lockOverlayTime">12:00</div>
        <div class="date" id="lockOverlayDate">×™×•× ×—××™×©×™, 18 ×‘×“×¦××‘×¨</div>
      </div>
      <div class="lock-hint" style="margin-top: 50px;">×œ×—×¥ ××• ×”×§×© ×œ×”××©×š</div>
    </div>
  </div>

  <script>
    // BIOS Content
    const biosLines = [
      'American Megatrends AMIBIOS(C) 2024',
      '',
      'BIOS Date: 11/15/24  Ver: 2.85.1247',
      'CPU: Intel(R) Core(TM) i7-13700K @ 5.40GHz',
      'Speed: 5400 MHz    Count: 16',
      '',
      'Press DEL to run Setup',
      'Press F12 for Boot Menu',
      '',
      'Initializing USB Controllers ... Done',
      'USB Device(s): 3 Keyboard, 1 Mouse, 2 Storage',
      '',
      'Auto-Detecting SATA1... Samsung SSD 990 PRO 2TB',
      'Auto-Detecting SATA2... WD Black 4TB',
      'Auto-Detecting SATA3... None',
      '',
      'Memory Test: 32768MB OK',
      '',
      'Checking NVRAM...',
      'Initializing Intel(R) Boot Agent...',
      '',
      '>>> Loading Operating System...',
    ];

    let biosIndex = 0;
    const biosContent = document.getElementById('biosContent');

    function typeBios() {
      if (biosIndex < biosLines.length) {
        const line = document.createElement('div');
        line.className = 'bios-line';
        line.textContent = biosLines[biosIndex] || '\u00A0';
        line.style.animationDelay = '0s';
        biosContent.appendChild(line);
        biosIndex++;
        setTimeout(typeBios, 80);
      } else {
        setTimeout(() => {
          document.getElementById('biosScreen').style.display = 'none';
          document.getElementById('bootScreen').style.display = 'flex';
          setTimeout(showWindowsLoading, 2500);
        }, 800);
      }
    }

    function showWindowsLoading() {
      document.getElementById('bootScreen').style.display = 'none';
      document.getElementById('loadingScreen').style.display = 'flex';
      
      const texts = ['Getting things ready', 'Just a moment...', 'Getting Windows ready', 'Almost there...'];
      let ti = 0;
      const textInterval = setInterval(() => {
        ti = (ti + 1) % texts.length;
        document.getElementById('loadingText').textContent = texts[ti];
      }, 2000);

      setTimeout(() => {
        clearInterval(textInterval);
        document.getElementById('loadingScreen').style.display = 'none';
        document.getElementById('lockScreen').style.display = 'flex';
        updateLockTime();
      }, 5000);
    }

    function updateLockTime() {
      const now = new Date();
      document.getElementById('lockTime').textContent = now.toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' });
      const options = { weekday: 'long', day: 'numeric', month: 'long' };
      document.getElementById('lockDate').textContent = now.toLocaleDateString('he-IL', options);
    }

    document.getElementById('lockScreen').onclick = () => {
      document.getElementById('lockScreen').style.display = 'none';
      document.getElementById('loginScreen').style.display = 'flex';
      document.getElementById('passwordInput').focus();
    };

    document.getElementById('passwordInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') login();
    });

    function login() {
      document.getElementById('loginScreen').style.display = 'none';
      document.getElementById('welcomeScreen').style.display = 'flex';
      
      setTimeout(() => {
        document.getElementById('welcomeScreen').style.display = 'none';
        document.getElementById('desktopContainer').style.display = 'block';
        updateClock();
      }, 2500);
    }

    function shutdown() {
      document.getElementById('startMenu').classList.remove('open');
      document.getElementById('desktopContainer').style.display = 'none';
      document.getElementById('shutdownScreen').style.display = 'flex';
      
      setTimeout(() => {
        document.getElementById('shutdownText').textContent = 'Shutting down...';
      }, 1500);
      
      setTimeout(() => {
        document.getElementById('shutdownScreen').style.display = 'none';
        // Restart
        biosIndex = 0;
        biosContent.innerHTML = '';
        document.getElementById('biosScreen').style.display = 'block';
        typeBios();
      }, 4000);
    }

    // Clock
    function updateClock() {
      const now = new Date();
      document.getElementById('time').textContent = now.toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' });
      document.getElementById('date').textContent = now.toLocaleDateString('he-IL');
    }
    setInterval(updateClock, 1000);

    // Start Menu
    function toggleStartMenu() {
      document.getElementById('startMenu').classList.toggle('open');
    }

    // Windows
    function openWindow(name) {
      document.getElementById('startMenu').classList.remove('open');
      const win = document.getElementById(name + 'Window');
      if (win) { win.classList.add('open'); bringToFront(win); }
    }

    function closeWindow(name) {
      const win = document.getElementById(name + 'Window');
      if (win) win.classList.remove('open');
    }

    // Dragging
    let draggedWindow = null, offsetX, offsetY;

    function startDrag(e, winId) {
      draggedWindow = document.getElementById(winId);
      bringToFront(draggedWindow);
      offsetX = e.clientX - draggedWindow.offsetLeft;
      offsetY = e.clientY - draggedWindow.offsetTop;
    }

    document.addEventListener('mousemove', (e) => {
      if (draggedWindow) {
        draggedWindow.style.left = (e.clientX - offsetX) + 'px';
        draggedWindow.style.top = (e.clientY - offsetY) + 'px';
      }
    });

    document.addEventListener('mouseup', () => { draggedWindow = null; });

    let zIndex = 50;
    function bringToFront(win) { zIndex++; win.style.zIndex = zIndex; }

    document.querySelectorAll('.window').forEach(win => {
      win.addEventListener('mousedown', () => bringToFront(win));
    });

    // Context Menu
    document.addEventListener('contextmenu', (e) => {
      if (!e.target.closest('.window') && !e.target.closest('.taskbar') && !e.target.closest('.start-menu')) {
        e.preventDefault();
        const menu = document.getElementById('contextMenu');
        menu.classList.add('open');
        menu.style.left = e.clientX + 'px';
        menu.style.top = e.clientY + 'px';
      }
    });

    document.addEventListener('click', (e) => {
      document.getElementById('contextMenu').classList.remove('open');
      if (!e.target.closest('.start-menu') && !e.target.closest('.start-btn')) {
        document.getElementById('startMenu').classList.remove('open');
      }
    });

    // ====== FILE SYSTEM ======
    const fileSystem = {
      'This PC': {
        type: 'folder',
        icon: 'ğŸ’»',
        children: {
          'Desktop': { type: 'folder', icon: 'ğŸ“' },
          'Documents': { type: 'folder', icon: 'ğŸ“„' },
          'Downloads': { type: 'folder', icon: 'â¬‡ï¸' },
          'Music': { type: 'folder', icon: 'ğŸµ' },
          'Pictures': { type: 'folder', icon: 'ğŸ–¼ï¸' },
          'Videos': { type: 'folder', icon: 'ğŸ¬' },
          'Local Disk (C:)': { type: 'drive', icon: 'ğŸ’¿' },
          'Local Disk (D:)': { type: 'drive', icon: 'ğŸ’¿' }
        }
      },
      'Desktop': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Projects': { type: 'folder', icon: 'ğŸ“' },
          'Work': { type: 'folder', icon: 'ğŸ“' },
          'notes.txt': { type: 'file', icon: 'ğŸ“„' },
          'image.png': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Desktop/Projects': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Website': { type: 'folder', icon: 'ğŸ“' },
          'App': { type: 'folder', icon: 'ğŸ“' },
          'README.md': { type: 'file', icon: 'ğŸ“„' },
          'config.json': { type: 'file', icon: 'âš™ï¸' }
        }
      },
      'Desktop/Projects/Website': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'src': { type: 'folder', icon: 'ğŸ“' },
          'public': { type: 'folder', icon: 'ğŸ“' },
          'index.html': { type: 'file', icon: 'ğŸŒ' },
          'style.css': { type: 'file', icon: 'ğŸ¨' },
          'script.js': { type: 'file', icon: 'ğŸ“œ' }
        }
      },
      'Desktop/Projects/Website/src': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'components': { type: 'folder', icon: 'ğŸ“' },
          'App.js': { type: 'file', icon: 'ğŸ“œ' },
          'main.js': { type: 'file', icon: 'ğŸ“œ' }
        }
      },
      'Desktop/Projects/Website/src/components': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Header.js': { type: 'file', icon: 'ğŸ“œ' },
          'Footer.js': { type: 'file', icon: 'ğŸ“œ' },
          'Button.js': { type: 'file', icon: 'ğŸ“œ' }
        }
      },
      'Desktop/Projects/Website/public': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'images': { type: 'folder', icon: 'ğŸ“' },
          'favicon.ico': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Desktop/Projects/Website/public/images': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'logo.png': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'banner.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'icons': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Desktop/Projects/Website/public/images/icons': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'home.svg': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'settings.svg': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Desktop/Projects/App': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'android': { type: 'folder', icon: 'ğŸ“' },
          'ios': { type: 'folder', icon: 'ğŸ“' },
          'package.json': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Desktop/Projects/App/android': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'app': { type: 'folder', icon: 'ğŸ“' },
          'build.gradle': { type: 'file', icon: 'âš™ï¸' }
        }
      },
      'Desktop/Projects/App/android/app': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'src': { type: 'folder', icon: 'ğŸ“' },
          'MainActivity.java': { type: 'file', icon: 'â˜•' }
        }
      },
      'Desktop/Projects/App/android/app/src': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'main': { type: 'folder', icon: 'ğŸ“' },
          'test': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Desktop/Projects/App/android/app/src/main': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'res': { type: 'folder', icon: 'ğŸ“' },
          'AndroidManifest.xml': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Desktop/Projects/App/android/app/src/main/res': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'drawable': { type: 'folder', icon: 'ğŸ“' },
          'layout': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Desktop/Projects/App/android/app/src/main/res/drawable': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'icon.png': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Desktop/Projects/App/android/app/src/main/res/layout': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'activity_main.xml': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Desktop/Projects/App/android/app/src/test': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'MainTest.java': { type: 'file', icon: 'â˜•' }
        }
      },
      'Desktop/Projects/App/ios': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Runner': { type: 'folder', icon: 'ğŸ“' },
          'Podfile': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Desktop/Projects/App/ios/Runner': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Assets.xcassets': { type: 'folder', icon: 'ğŸ“' },
          'AppDelegate.swift': { type: 'file', icon: 'ğŸ“œ' }
        }
      },
      'Desktop/Projects/App/ios/Runner/Assets.xcassets': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'AppIcon.appiconset': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Desktop/Projects/App/ios/Runner/Assets.xcassets/AppIcon.appiconset': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'icon-20.png': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'icon-40.png': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'Contents.json': { type: 'file', icon: 'âš™ï¸' }
        }
      },
      'Desktop/Work': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Reports': { type: 'folder', icon: 'ğŸ“' },
          'Meetings': { type: 'folder', icon: 'ğŸ“' },
          'presentation.pptx': { type: 'file', icon: 'ğŸ“Š' },
          'budget.xlsx': { type: 'file', icon: 'ğŸ“ˆ' }
        }
      },
      'Desktop/Work/Reports': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Q1': { type: 'folder', icon: 'ğŸ“' },
          'Q2': { type: 'folder', icon: 'ğŸ“' },
          'Annual Report.docx': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Desktop/Work/Reports/Q1': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'January.xlsx': { type: 'file', icon: 'ğŸ“ˆ' },
          'February.xlsx': { type: 'file', icon: 'ğŸ“ˆ' },
          'March.xlsx': { type: 'file', icon: 'ğŸ“ˆ' }
        }
      },
      'Desktop/Work/Reports/Q2': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'April.xlsx': { type: 'file', icon: 'ğŸ“ˆ' },
          'May.xlsx': { type: 'file', icon: 'ğŸ“ˆ' },
          'June.xlsx': { type: 'file', icon: 'ğŸ“ˆ' }
        }
      },
      'Desktop/Work/Meetings': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Team Meetings': { type: 'folder', icon: 'ğŸ“' },
          'Client Meetings': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Desktop/Work/Meetings/Team Meetings': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'weekly-sync.docx': { type: 'file', icon: 'ğŸ“„' },
          'retrospective.docx': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Desktop/Work/Meetings/Client Meetings': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'client-a-notes.docx': { type: 'file', icon: 'ğŸ“„' },
          'client-b-notes.docx': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Documents': {
        type: 'folder',
        icon: 'ğŸ“„',
        children: {
          'Personal': { type: 'folder', icon: 'ğŸ“' },
          'Templates': { type: 'folder', icon: 'ğŸ“' },
          'resume.docx': { type: 'file', icon: 'ğŸ“„' },
          'notes.txt': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Documents/Personal': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Letters': { type: 'folder', icon: 'ğŸ“' },
          'diary.txt': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Documents/Personal/Letters': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'letter-2024.docx': { type: 'file', icon: 'ğŸ“„' },
          'letter-2023.docx': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Documents/Templates': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'invoice-template.xlsx': { type: 'file', icon: 'ğŸ“ˆ' },
          'report-template.docx': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Downloads': {
        type: 'folder',
        icon: 'â¬‡ï¸',
        children: {
          'software-installer.exe': { type: 'file', icon: 'ğŸ’¿' },
          'document.pdf': { type: 'file', icon: 'ğŸ“•' },
          'photo.zip': { type: 'file', icon: 'ğŸ“¦' }
        }
      },
      'Music': {
        type: 'folder',
        icon: 'ğŸµ',
        children: {
          'Playlists': { type: 'folder', icon: 'ğŸ“' },
          'favorite-song.mp3': { type: 'file', icon: 'ğŸµ' },
          'album.zip': { type: 'file', icon: 'ğŸ“¦' }
        }
      },
      'Music/Playlists': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Rock': { type: 'folder', icon: 'ğŸ“' },
          'Jazz': { type: 'folder', icon: 'ğŸ“' },
          'workout.m3u': { type: 'file', icon: 'ğŸµ' }
        }
      },
      'Music/Playlists/Rock': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'song1.mp3': { type: 'file', icon: 'ğŸµ' },
          'song2.mp3': { type: 'file', icon: 'ğŸµ' }
        }
      },
      'Music/Playlists/Jazz': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'smooth-jazz.mp3': { type: 'file', icon: 'ğŸµ' },
          'classic.mp3': { type: 'file', icon: 'ğŸµ' }
        }
      },
      'Pictures': {
        type: 'folder',
        icon: 'ğŸ–¼ï¸',
        children: {
          'Screenshots': { type: 'folder', icon: 'ğŸ“' },
          'Wallpapers': { type: 'folder', icon: 'ğŸ“' },
          'Photos': { type: 'folder', icon: 'ğŸ“' },
          'vacation.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Pictures/Screenshots': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'screenshot-1.png': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'screenshot-2.png': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Pictures/Wallpapers': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'nature': { type: 'folder', icon: 'ğŸ“' },
          'abstract': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Pictures/Wallpapers/nature': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'mountain.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'ocean.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'forest.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Pictures/Wallpapers/abstract': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'gradient-1.png': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'gradient-2.png': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Pictures/Photos': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          '2024': { type: 'folder', icon: 'ğŸ“' },
          '2023': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Pictures/Photos/2024': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'January': { type: 'folder', icon: 'ğŸ“' },
          'February': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Pictures/Photos/2024/January': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'IMG_001.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'IMG_002.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Pictures/Photos/2024/February': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'IMG_010.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'IMG_011.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Pictures/Photos/2023': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'December': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Pictures/Photos/2023/December': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'holiday-1.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' },
          'holiday-2.jpg': { type: 'file', icon: 'ğŸ–¼ï¸' }
        }
      },
      'Videos': {
        type: 'folder',
        icon: 'ğŸ¬',
        children: {
          'Movies': { type: 'folder', icon: 'ğŸ“' },
          'Recordings': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Videos/Movies': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'movie-2024.mp4': { type: 'file', icon: 'ğŸ¬' }
        }
      },
      'Videos/Recordings': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'meeting-recording.mp4': { type: 'file', icon: 'ğŸ¬' },
          'tutorial.mp4': { type: 'file', icon: 'ğŸ¬' }
        }
      },
      'Local Disk (C:)': {
        type: 'folder',
        icon: 'ğŸ’¿',
        children: {
          'Program Files': { type: 'folder', icon: 'ğŸ“' },
          'Users': { type: 'folder', icon: 'ğŸ“' },
          'Windows': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Local Disk (C:)/Program Files': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Microsoft': { type: 'folder', icon: 'ğŸ“' },
          'Common Files': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Local Disk (C:)/Program Files/Microsoft': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Edge': { type: 'folder', icon: 'ğŸ“' },
          'Office': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Local Disk (C:)/Program Files/Microsoft/Edge': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'msedge.exe': { type: 'file', icon: 'ğŸŒ' }
        }
      },
      'Local Disk (C:)/Program Files/Microsoft/Office': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'WINWORD.EXE': { type: 'file', icon: 'ğŸ’¼' },
          'EXCEL.EXE': { type: 'file', icon: 'ğŸ“Š' }
        }
      },
      'Local Disk (C:)/Program Files/Common Files': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'shared.dll': { type: 'file', icon: 'âš™ï¸' }
        }
      },
      'Local Disk (C:)/Users': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Shalom': { type: 'folder', icon: 'ğŸ‘¤' },
          'Public': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Local Disk (C:)/Users/Shalom': {
        type: 'folder',
        icon: 'ğŸ‘¤',
        children: {
          'Desktop': { type: 'folder', icon: 'ğŸ“' },
          'Documents': { type: 'folder', icon: 'ğŸ“„' },
          'Downloads': { type: 'folder', icon: 'â¬‡ï¸' }
        }
      },
      'Local Disk (C:)/Users/Shalom/Desktop': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'shortcut.lnk': { type: 'file', icon: 'ğŸ”—' }
        }
      },
      'Local Disk (C:)/Users/Shalom/Documents': {
        type: 'folder',
        icon: 'ğŸ“„',
        children: {
          'file.docx': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Local Disk (C:)/Users/Shalom/Downloads': {
        type: 'folder',
        icon: 'â¬‡ï¸',
        children: {
          'setup.exe': { type: 'file', icon: 'ğŸ’¿' }
        }
      },
      'Local Disk (C:)/Users/Public': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Public Documents': { type: 'folder', icon: 'ğŸ“„' }
        }
      },
      'Local Disk (C:)/Users/Public/Public Documents': {
        type: 'folder',
        icon: 'ğŸ“„',
        children: {
          'readme.txt': { type: 'file', icon: 'ğŸ“„' }
        }
      },
      'Local Disk (C:)/Windows': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'System32': { type: 'folder', icon: 'ğŸ“' },
          'Fonts': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Local Disk (C:)/Windows/System32': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'cmd.exe': { type: 'file', icon: 'â¬›' },
          'notepad.exe': { type: 'file', icon: 'ğŸ“' }
        }
      },
      'Local Disk (C:)/Windows/Fonts': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'arial.ttf': { type: 'file', icon: 'ğŸ”¤' },
          'times.ttf': { type: 'file', icon: 'ğŸ”¤' }
        }
      },
      'Local Disk (D:)': {
        type: 'folder',
        icon: 'ğŸ’¿',
        children: {
          'Games': { type: 'folder', icon: 'ğŸ®' },
          'Backup': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Local Disk (D:)/Games': {
        type: 'folder',
        icon: 'ğŸ®',
        children: {
          'Steam': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Local Disk (D:)/Games/Steam': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'steamapps': { type: 'folder', icon: 'ğŸ“' },
          'steam.exe': { type: 'file', icon: 'ğŸ®' }
        }
      },
      'Local Disk (D:)/Games/Steam/steamapps': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'common': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Local Disk (D:)/Games/Steam/steamapps/common': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'Game1': { type: 'folder', icon: 'ğŸ®' },
          'Game2': { type: 'folder', icon: 'ğŸ®' }
        }
      },
      'Local Disk (D:)/Games/Steam/steamapps/common/Game1': {
        type: 'folder',
        icon: 'ğŸ®',
        children: {
          'game.exe': { type: 'file', icon: 'ğŸ®' },
          'config.ini': { type: 'file', icon: 'âš™ï¸' }
        }
      },
      'Local Disk (D:)/Games/Steam/steamapps/common/Game2': {
        type: 'folder',
        icon: 'ğŸ®',
        children: {
          'launcher.exe': { type: 'file', icon: 'ğŸ®' }
        }
      },
      'Local Disk (D:)/Backup': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          '2024': { type: 'folder', icon: 'ğŸ“' },
          '2023': { type: 'folder', icon: 'ğŸ“' }
        }
      },
      'Local Disk (D:)/Backup/2024': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'backup-jan.zip': { type: 'file', icon: 'ğŸ“¦' },
          'backup-feb.zip': { type: 'file', icon: 'ğŸ“¦' }
        }
      },
      'Local Disk (D:)/Backup/2023': {
        type: 'folder',
        icon: 'ğŸ“',
        children: {
          'full-backup.zip': { type: 'file', icon: 'ğŸ“¦' }
        }
      }
    };

    let currentPath = 'This PC';
    let historyStack = ['This PC'];
    let historyIndex = 0;

    function renderExplorer(path) {
      const content = document.getElementById('explorerContent');
      const pathDisplay = document.getElementById('pathDisplay');
      const folder = fileSystem[path];
      
      content.innerHTML = '';
      pathDisplay.textContent = path;
      
      // Update sidebar active state
      document.querySelectorAll('.sidebar-item').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.location === path.split('/')[0]) {
          item.classList.add('active');
        }
      });

      // Update navigation buttons
      document.getElementById('backBtn').classList.toggle('disabled', historyIndex <= 0);
      document.getElementById('forwardBtn').classList.toggle('disabled', historyIndex >= historyStack.length - 1);

      if (!folder || !folder.children) {
        content.innerHTML = '<div style="color: #888; padding: 20px;">This folder is empty</div>';
        return;
      }

      Object.keys(folder.children).forEach(name => {
        const item = folder.children[name];
        const div = document.createElement('div');
        div.className = 'folder-item';
        div.innerHTML = `<div style="font-size: 40px;">${item.icon}</div><span>${name}</span>`;
        
        if (item.type === 'folder' || item.type === 'drive') {
          div.ondblclick = () => {
            const newPath = path === 'This PC' ? name : `${path}/${name}`;
            navigateTo(newPath, true);
          };
        } else {
          div.ondblclick = () => {
            // Open file action (could be extended)
            alert(`×¤×•×ª×— ×§×•×‘×¥: ${name}`);
          };
        }
        
        div.onclick = (e) => {
          document.querySelectorAll('.folder-item').forEach(f => f.classList.remove('selected'));
          div.classList.add('selected');
        };
        
        content.appendChild(div);
      });
    }

    function navigateTo(path, addToHistory = true) {
      if (addToHistory && path !== currentPath) {
        // Remove forward history if navigating to new path
        historyStack = historyStack.slice(0, historyIndex + 1);
        historyStack.push(path);
        historyIndex = historyStack.length - 1;
      }
      currentPath = path;
      renderExplorer(path);
    }

    function goBack() {
      if (historyIndex > 0) {
        historyIndex--;
        currentPath = historyStack[historyIndex];
        renderExplorer(currentPath);
      }
    }

    function goForward() {
      if (historyIndex < historyStack.length - 1) {
        historyIndex++;
        currentPath = historyStack[historyIndex];
        renderExplorer(currentPath);
      }
    }

    function refreshExplorer() {
      renderExplorer(currentPath);
    }

    // Initialize explorer when opened
    const origOpenWindow = openWindow;
    openWindow = function(name) {
      origOpenWindow(name);
      if (name === 'explorer') {
        renderExplorer(currentPath);
      }
    };

    // ====== BROWSER FUNCTIONS ======
    let browserHistory = ['https://www.google.com/webhp?igu=1'];
    let browserHistoryIndex = 0;

    function browserNavigate(url) {
      const urlInput = document.getElementById('browserUrl');
      const frame = document.getElementById('browserFrame');
      const loading = document.getElementById('browserLoading');
      
      let targetUrl = url || urlInput.value.trim();
      
      // Add https:// if missing
      if (targetUrl && !targetUrl.startsWith('http://') && !targetUrl.startsWith('https://')) {
        // Check if it's a search query or a URL
        if (targetUrl.includes('.') && !targetUrl.includes(' ')) {
          targetUrl = 'https://' + targetUrl;
        } else {
          // Use Google search
          targetUrl = 'https://www.google.com/search?igu=1&q=' + encodeURIComponent(targetUrl);
        }
      }
      
      urlInput.value = targetUrl;
      
      // Show loading
      loading.style.display = 'block';
      
      // Update history
      if (targetUrl !== browserHistory[browserHistoryIndex]) {
        browserHistory = browserHistory.slice(0, browserHistoryIndex + 1);
        browserHistory.push(targetUrl);
        browserHistoryIndex = browserHistory.length - 1;
      }
      
      // Navigate
      frame.src = targetUrl;
      
      // Update tab title
      updateTabTitle(targetUrl);
      
      // Hide loading after a delay
      setTimeout(() => {
        loading.style.display = 'none';
      }, 1500);
    }

    function browserBack() {
      if (browserHistoryIndex > 0) {
        browserHistoryIndex--;
        const url = browserHistory[browserHistoryIndex];
        document.getElementById('browserUrl').value = url;
        document.getElementById('browserFrame').src = url;
        updateTabTitle(url);
      }
    }

    function browserForward() {
      if (browserHistoryIndex < browserHistory.length - 1) {
        browserHistoryIndex++;
        const url = browserHistory[browserHistoryIndex];
        document.getElementById('browserUrl').value = url;
        document.getElementById('browserFrame').src = url;
        updateTabTitle(url);
      }
    }

    function browserRefresh() {
      const frame = document.getElementById('browserFrame');
      const loading = document.getElementById('browserLoading');
      loading.style.display = 'block';
      frame.src = frame.src;
      setTimeout(() => {
        loading.style.display = 'none';
      }, 1500);
    }

    function browserHome() {
      const homeUrl = 'https://www.google.com/webhp?igu=1';
      document.getElementById('browserUrl').value = homeUrl;
      browserNavigate(homeUrl);
    }

    function updateTabTitle(url) {
      const tabTitle = document.getElementById('tabTitle');
      const tabIcon = document.getElementById('tabIcon');
      
      try {
        const hostname = new URL(url).hostname.replace('www.', '');
        tabTitle.textContent = hostname || 'New Tab';
        
        // Set icon based on site
        if (url.includes('google')) {
          tabIcon.textContent = 'ğŸ”';
        } else if (url.includes('youtube')) {
          tabIcon.textContent = 'â–¶ï¸';
        } else if (url.includes('github')) {
          tabIcon.textContent = 'ğŸ™';
        } else if (url.includes('wikipedia')) {
          tabIcon.textContent = 'ğŸ“š';
        } else {
          tabIcon.textContent = 'ğŸŒ';
        }
      } catch (e) {
        tabTitle.textContent = 'New Tab';
        tabIcon.textContent = 'ğŸŒ';
      }
    }

    // Quick site navigation
    function goToSite(url) {
      document.getElementById('browserUrl').value = url;
      browserNavigate(url);
    }

    // ====== CALENDAR ======
    let currentCalendarDate = new Date();
    
    function toggleCalendar() {
      document.getElementById('quickSettings').classList.remove('open');
      document.getElementById('calendarPopup').classList.toggle('open');
      renderCalendar();
    }

    function renderCalendar() {
      const grid = document.getElementById('calendarGrid');
      const monthLabel = document.getElementById('calendarMonth');
      const year = currentCalendarDate.getFullYear();
      const month = currentCalendarDate.getMonth();
      
      monthLabel.textContent = new Date(year, month).toLocaleDateString('he-IL', { month: 'long', year: 'numeric' });
      
      grid.innerHTML = '';
      const days = ['×', '×‘', '×’', '×“', '×”', '×•', '×©'];
      days.forEach(d => grid.innerHTML += `<div class="calendar-day header">${d}</div>`);
      
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const today = new Date();
      
      for (let i = 0; i < firstDay; i++) {
        const prevDays = new Date(year, month, 0).getDate();
        grid.innerHTML += `<div class="calendar-day other-month">${prevDays - firstDay + i + 1}</div>`;
      }
      
      for (let i = 1; i <= daysInMonth; i++) {
        const isToday = today.getDate() === i && today.getMonth() === month && today.getFullYear() === year;
        grid.innerHTML += `<div class="calendar-day${isToday ? ' today' : ''}">${i}</div>`;
      }
    }

    function changeMonth(delta) {
      currentCalendarDate.setMonth(currentCalendarDate.getMonth() + delta);
      renderCalendar();
    }

    // ====== QUICK SETTINGS ======
    function toggleQuickSettings() {
      document.getElementById('calendarPopup').classList.remove('open');
      document.getElementById('quickSettings').classList.toggle('open');
    }

    function updateVolume(val) {
      document.getElementById('volumeVal').textContent = val + '%';
      const icon = document.getElementById('volumeIcon');
      if (val == 0) icon.textContent = 'ğŸ”‡';
      else if (val < 50) icon.textContent = 'ğŸ”‰';
      else icon.textContent = 'ğŸ”Š';
    }

    document.getElementById('brightnessSlider')?.addEventListener('input', function() {
      document.getElementById('brightnessVal').textContent = this.value + '%';
    });

    // ====== WIDGETS ======
    function toggleWidgets() {
      document.getElementById('widgetsPanel').classList.toggle('open');
    }

    // ====== WINDOW MANAGEMENT ======
    let windowStates = {};
    let openWindows = new Set();

    function minimizeWindow(name) {
      const win = document.getElementById(name + 'Window');
      if (win) {
        win.classList.add('minimized');
        updateTaskbar();
      }
    }

    function maximizeWindow(name) {
      const win = document.getElementById(name + 'Window');
      if (win) {
        if (win.classList.contains('maximized')) {
          win.classList.remove('maximized');
          if (windowStates[name]) {
            win.style.top = windowStates[name].top;
            win.style.left = windowStates[name].left;
            win.style.width = windowStates[name].width;
            win.style.height = windowStates[name].height;
          }
        } else {
          windowStates[name] = {
            top: win.style.top,
            left: win.style.left,
            width: win.style.width,
            height: win.style.height
          };
          win.classList.add('maximized');
        }
      }
    }

    // Override openWindow to track open windows
    const baseOpenWindow = openWindow;
    openWindow = function(name) {
      const win = document.getElementById(name + 'Window');
      if (win) {
        win.classList.remove('minimized');
        openWindows.add(name);
        updateTaskbar();
      }
      baseOpenWindow(name);
      if (name === 'paint') initPaint();
      if (name === 'taskmanager') updateTaskManager();
    };

    // Override closeWindow
    const baseCloseWindow = closeWindow;
    closeWindow = function(name) {
      openWindows.delete(name);
      updateTaskbar();
      baseCloseWindow(name);
    };

    function updateTaskbar() {
      const apps = ['edge', 'explorer', 'terminal', 'notepad'];
      apps.forEach(app => {
        const btn = document.getElementById('taskbar-' + app);
        if (btn) {
          const win = document.getElementById(app + 'Window');
          if (win && win.classList.contains('open') && !win.classList.contains('minimized')) {
            btn.classList.add('running');
          } else {
            btn.classList.remove('running');
          }
        }
      });
    }

    // ====== CALCULATOR ======
    let calcValue = '0';
    let calcOperator = null;
    let calcPrevValue = null;
    let calcNewNumber = true;

    function calcInput(val) {
      if (['+', '-', '*', '/'].includes(val)) {
        calcOperator = val;
        calcPrevValue = parseFloat(calcValue);
        calcNewNumber = true;
      } else if (val === '%') {
        calcValue = (parseFloat(calcValue) / 100).toString();
      } else if (val === 'Â±') {
        calcValue = (parseFloat(calcValue) * -1).toString();
      } else {
        if (calcNewNumber) {
          calcValue = val;
          calcNewNumber = false;
        } else {
          calcValue = calcValue === '0' ? val : calcValue + val;
        }
      }
      document.getElementById('calcDisplay').textContent = calcValue;
    }

    function calcResult() {
      if (calcOperator && calcPrevValue !== null) {
        const current = parseFloat(calcValue);
        let result;
        switch (calcOperator) {
          case '+': result = calcPrevValue + current; break;
          case '-': result = calcPrevValue - current; break;
          case '*': result = calcPrevValue * current; break;
          case '/': result = calcPrevValue / current; break;
        }
        calcValue = result.toString();
        document.getElementById('calcDisplay').textContent = calcValue;
        calcOperator = null;
        calcPrevValue = null;
        calcNewNumber = true;
      }
    }

    function clearCalc() {
      calcValue = '0';
      calcOperator = null;
      calcPrevValue = null;
      calcNewNumber = true;
      document.getElementById('calcDisplay').textContent = '0';
    }

    // ====== TERMINAL ======
    const terminalCommands = {
      help: 'Available commands: help, dir, cls, echo, date, time, whoami, ver, color, exit',
      dir: 'Directory of C:\\Users\\Shalom\n\n  Desktop\n  Documents\n  Downloads\n  Music\n  Pictures\n  Videos\n\n  6 Dir(s)',
      cls: 'CLEAR',
      whoami: 'Shalom',
      ver: 'Microsoft Windows [Version 10.0.22631.2861]',
      date: () => new Date().toLocaleDateString(),
      time: () => new Date().toLocaleTimeString(),
      exit: 'Closing terminal...'
    };

    function executeCommand() {
      const input = document.getElementById('terminalInput');
      const output = document.getElementById('terminalOutput');
      const cmd = input.value.trim().toLowerCase();
      
      output.textContent += `C:\\Users\\Shalom>${input.value}\n`;
      
      if (cmd === 'cls') {
        output.textContent = '';
      } else if (cmd.startsWith('echo ')) {
        output.textContent += cmd.substring(5) + '\n';
      } else if (cmd.startsWith('color ')) {
        const colors = { '0': '#000', '1': '#00f', '2': '#0f0', '3': '#0ff', '4': '#f00', 'a': '#0f0' };
        output.style.color = colors[cmd.substring(6)] || '#fff';
      } else if (terminalCommands[cmd]) {
        const result = typeof terminalCommands[cmd] === 'function' ? terminalCommands[cmd]() : terminalCommands[cmd];
        output.textContent += result + '\n';
        if (cmd === 'exit') setTimeout(() => closeWindow('terminal'), 500);
      } else if (cmd) {
        output.textContent += `'${cmd}' is not recognized as an internal or external command.\n`;
      }
      
      output.textContent += '\n';
      input.value = '';
      output.scrollTop = output.scrollHeight;
    }

    // ====== TASK MANAGER ======
    function updateTaskManager() {
      document.getElementById('cpuUsage').textContent = Math.floor(Math.random() * 40 + 10) + '%';
      document.getElementById('memUsage').textContent = Math.floor(Math.random() * 30 + 50) + '%';
      document.getElementById('diskUsage').textContent = Math.floor(Math.random() * 20 + 5) + '%';

      const tasks = [
        { name: 'System', icon: 'âš™ï¸', cpu: '0.1%', mem: '0.2 MB' },
        { name: 'Windows Explorer', icon: 'ğŸ“', cpu: '0.5%', mem: '45.2 MB' },
        { name: 'Microsoft Edge', icon: 'ğŸŒ', cpu: '2.3%', mem: '312.1 MB' },
        { name: 'Desktop Window Manager', icon: 'ğŸ–¥ï¸', cpu: '1.2%', mem: '89.5 MB' },
        { name: 'Windows Security', icon: 'ğŸ›¡ï¸', cpu: '0.0%', mem: '12.4 MB' }
      ];

      const list = document.getElementById('taskList');
      list.innerHTML = tasks.map(t => `
        <div class="task-item">
          <div class="task-info">
            <span>${t.icon}</span>
            <span>${t.name}</span>
          </div>
          <div style="display: flex; gap: 20px; align-items: center;">
            <span style="color: #888; font-size: 12px;">${t.cpu}</span>
            <span style="color: #888; font-size: 12px;">${t.mem}</span>
            <button class="task-end">End task</button>
          </div>
        </div>
      `).join('');
    }

    // ====== PAINT ======
    let paintColor = '#000';
    let paintSize = 2;
    let painting = false;
    let paintCtx = null;

    function initPaint() {
      const canvas = document.getElementById('paintCanvas');
      if (!canvas) return;
      const rect = canvas.parentElement.getBoundingClientRect();
      canvas.width = rect.width;
      canvas.height = rect.height - 50;
      paintCtx = canvas.getContext('2d');
      paintCtx.fillStyle = '#fff';
      paintCtx.fillRect(0, 0, canvas.width, canvas.height);

      canvas.onmousedown = (e) => { painting = true; paintCtx.beginPath(); };
      canvas.onmouseup = () => painting = false;
      canvas.onmouseout = () => painting = false;
      canvas.onmousemove = (e) => {
        if (!painting) return;
        const rect = canvas.getBoundingClientRect();
        paintCtx.lineWidth = paintSize;
        paintCtx.lineCap = 'round';
        paintCtx.strokeStyle = paintColor;
        paintCtx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
        paintCtx.stroke();
        paintCtx.beginPath();
        paintCtx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
      };
    }

    function setPaintColor(color, el) {
      paintColor = color;
      document.querySelectorAll('.paint-color').forEach(c => c.classList.remove('active'));
      el.classList.add('active');
    }

    function setPaintSize(size, el) {
      paintSize = size;
      document.querySelectorAll('.paint-size').forEach(s => s.classList.remove('active'));
      el.classList.add('active');
    }

    function clearCanvas() {
      if (paintCtx) {
        const canvas = document.getElementById('paintCanvas');
        paintCtx.fillStyle = '#fff';
        paintCtx.fillRect(0, 0, canvas.width, canvas.height);
      }
    }

    // ====== SEARCH ======
    function filterApps(query) {
      const apps = document.querySelectorAll('#pinnedApps .app-item');
      apps.forEach(app => {
        const name = app.dataset.name || '';
        const text = app.textContent.toLowerCase();
        app.style.display = (text.includes(query.toLowerCase()) || name.includes(query.toLowerCase())) ? '' : 'none';
      });
    }

    // ====== KEYBOARD SHORTCUTS ======
    let altTabIndex = 0;
    let altTabWindows = [];

    document.addEventListener('keydown', (e) => {
      // Win key
      if (e.key === 'Meta' || (e.key === 'Control' && e.altKey)) {
        toggleStartMenu();
      }
      // Alt+Tab
      if (e.altKey && e.key === 'Tab') {
        e.preventDefault();
        showAltTab();
      }
      // Alt+F4
      if (e.altKey && e.key === 'F4') {
        e.preventDefault();
        const topWindow = getTopWindow();
        if (topWindow) closeWindow(topWindow.replace('Window', ''));
      }
      // Win+L
      if (e.metaKey && e.key === 'l') {
        e.preventDefault();
        lockScreen();
      }
      // Escape
      if (e.key === 'Escape') {
        document.getElementById('startMenu').classList.remove('open');
        document.getElementById('quickSettings').classList.remove('open');
        document.getElementById('calendarPopup').classList.remove('open');
        document.getElementById('altTabSwitcher').classList.remove('open');
        document.getElementById('widgetsPanel').classList.remove('open');
      }
    });

    function getTopWindow() {
      let topZ = 0, topWin = null;
      document.querySelectorAll('.window.open').forEach(w => {
        const z = parseInt(w.style.zIndex) || 0;
        if (z >= topZ) { topZ = z; topWin = w.id; }
      });
      return topWin;
    }

    function showAltTab() {
      altTabWindows = Array.from(document.querySelectorAll('.window.open')).map(w => ({
        id: w.id,
        title: w.querySelector('.window-title')?.textContent || 'Window',
        icon: w.querySelector('.window-title span')?.textContent || 'ğŸ“„'
      }));
      
      if (altTabWindows.length === 0) return;
      
      altTabIndex = (altTabIndex + 1) % altTabWindows.length;
      const switcher = document.getElementById('altTabSwitcher');
      switcher.innerHTML = altTabWindows.map((w, i) => `
        <div class="alt-tab-item${i === altTabIndex ? ' selected' : ''}" onclick="selectAltTab(${i})">
          <span>${w.icon}</span>
          <small>${w.title}</small>
        </div>
      `).join('');
      switcher.classList.add('open');
      
      setTimeout(() => switcher.classList.remove('open'), 2000);
    }

    function selectAltTab(index) {
      const win = document.getElementById(altTabWindows[index].id);
      if (win) {
        win.classList.remove('minimized');
        bringToFront(win);
      }
      document.getElementById('altTabSwitcher').classList.remove('open');
    }

    // ====== LOCK SCREEN ======
    function lockScreen() {
      document.getElementById('startMenu').classList.remove('open');
      const overlay = document.getElementById('lockOverlay');
      overlay.classList.add('show');
      updateLockOverlayTime();
      
      overlay.onclick = () => {
        overlay.classList.remove('show');
      };
    }

    function updateLockOverlayTime() {
      const now = new Date();
      const time = document.getElementById('lockOverlayTime');
      const date = document.getElementById('lockOverlayDate');
      if (time) time.textContent = now.toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit' });
      if (date) date.textContent = now.toLocaleDateString('he-IL', { weekday: 'long', day: 'numeric', month: 'long' });
    }

    // ====== BSOD EASTER EGG ======
    function triggerBSOD() {
      document.getElementById('startMenu').classList.remove('open');
      document.getElementById('bsodScreen').classList.add('show');
      
      let progress = 0;
      const interval = setInterval(() => {
        progress += Math.random() * 15;
        if (progress >= 100) {
          progress = 100;
          clearInterval(interval);
          setTimeout(() => {
            document.getElementById('bsodScreen').classList.remove('show');
            shutdown();
          }, 1500);
        }
        document.querySelector('.bsod-text').textContent = `We're just collecting some error info, and then we'll restart for you.\n\n${Math.floor(progress)}% complete`;
      }, 500);
    }

    // ====== FILE OPERATIONS ======
    function createNewFolder() {
      const name = prompt('×©× ×”×ª×™×§×™×™×” ×”×—×“×©×”:');
      if (name && fileSystem[currentPath]) {
        fileSystem[currentPath].children[name] = { type: 'folder', icon: 'ğŸ“' };
        fileSystem[currentPath + '/' + name] = { type: 'folder', icon: 'ğŸ“', children: {} };
        renderExplorer(currentPath);
      }
    }

    function createNewFile() {
      const name = prompt('×©× ×”×§×•×‘×¥ ×”×—×“×©:');
      if (name && fileSystem[currentPath]) {
        fileSystem[currentPath].children[name] = { type: 'file', icon: 'ğŸ“„' };
        renderExplorer(currentPath);
      }
    }

    // Close popups on outside click
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.calendar-popup') && !e.target.closest('.clock')) {
        document.getElementById('calendarPopup').classList.remove('open');
      }
      if (!e.target.closest('.quick-settings') && !e.target.closest('.system-tray')) {
        document.getElementById('quickSettings').classList.remove('open');
      }
      if (!e.target.closest('.widgets-panel') && !e.target.closest('.taskbar-btn')) {
        document.getElementById('widgetsPanel').classList.remove('open');
      }
    });

    // Start Boot
    setTimeout(typeBios, 500);
  </script>
</body>
</html>
